# Network

This folder contains network configurations that can be shared across your NixOS hosts.

> **Available languages**: [English (current)](README.md) | [Italiano](README.it.md)

## Structure

```bash
network/
├── networkmanager.nix      # Main NetworkManager configuration
└── nmconnection_files/     # NetworkManager connection files
    ├── example-wifi.nmconnection
    ├── example-vpn.nmconnection
    └── ...other connection files...
```

## Available Files

- **`networkmanager.nix`** - Configures NetworkManager as the network connection manager

### `nmconnection_files` Subfolder

This folder contains `.nmconnection` files that define specific connections for NetworkManager. These files can be generated by NetworkManager itself or created manually.

## Usage

### Base NetworkManager Configuration

To enable NetworkManager on your host, import the `networkmanager.nix` file in your `configuration.nix` file:

```nix
imports = [
  # ...other imports...
  ../common/network/networkmanager.nix
];
```

### Using Connection Files

The `.nmconnection` files contain details to configure specific connections (WiFi, Ethernet, VPN, etc.). To use them:

1. Create a `nm_configurations.nix` file in your specific host folder:

```nix
{ config, lib, pkgs, ... }:

{
  # Copy desired connection files to the NetworkManager directory
  environment.etc = {
    "NetworkManager/system-connections/my-home-wifi.nmconnection" = {
      source = ../common/network/nmconnection_files/my-home-wifi.nmconnection;
      mode = "0600"; # Important: .nmconnection files require restrictive permissions
    };
    
    "NetworkManager/system-connections/work-vpn.nmconnection" = {
      source = ../common/network/nmconnection_files/work-vpn.nmconnection;
      mode = "0600";
    };
    
    # Add other connection files as needed
  };
}
```

2. Import this file in your host's `configuration.nix` file:

```nix
imports = [
  # ...other imports...
  ../common/network/networkmanager.nix
  ./nm_configurations.nix
];
```

## Security Notes

- The `.nmconnection` files may contain passwords and other sensitive information. Make sure to:
  - Set appropriate permissions (mode = "0600")
  - Consider using more secure methods like Nix Secrets for credentials
  - Avoid committing sensitive information to version control

## Customization

You can extend the network configuration by:

- Adding new `.nmconnection` files to the `nmconnection_files` folder
- Modifying the `networkmanager.nix` file to change default settings
- Creating alternative configurations for other networking systems (like systemd-networkd)